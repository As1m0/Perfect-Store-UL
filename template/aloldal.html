<h2>Ez egy aloldal</h2>

<div class="chart-container" style="width: 80vw; background-color: aliceblue;">
    <canvas id="myChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const API_BASE_URL = './api/index.php'; // Updated for no mod_rewrite

    async function loadChartData(startDate = null, endDate = null) {
        try {
            let url = `${API_BASE_URL}/chart-data`;
            if (startDate || endDate) {
                const params = new URLSearchParams();
                if (startDate) params.append('start_date', startDate);
                if (endDate) params.append('end_date', endDate);
                url += `&${params.toString()}`;
            }

            const response = await fetch(url);
            const responseData = await response.json();

            if (responseData.success) {
                return responseData.data;
            } else {
                throw new Error(responseData.message);
            }
        } catch (error) {
            console.error('Error loading chart data:', error);
            throw error;
        }
    }

    const ctx = document.getElementById('myChart');

    (async function() {
        const Chartdata = await loadChartData();
        console.log('Chart data:', Chartdata);
        new Chart(ctx, {
            type: 'line',
            data: Chartdata,
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    })();
</script>